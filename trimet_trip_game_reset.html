<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<title>Trimet Trip Game</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
     integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
     crossorigin=""/>
 <!-- Make sure you put this AFTER Leaflet's CSS -->
 <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
     integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
     crossorigin=""></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet-textpath@1.2.0/leaflet.textpath.min.js"></script>

<style>

#map { height: 80vh; z-index: 8;}




</style>

</head>

    <div id="map"></div> 
    

<body>
 
 
<script>


var xhReq = new XMLHttpRequest();
xhReq.open("GET", "https://meysohn-sandbox.s3.amazonaws.com/trimet_trip_planner/tm_route_buffer_blockgroup.geojson", false);
xhReq.send(null);
var tm_route_buffer_blockgroup = JSON.parse(xhReq.responseText);


var map = L.map('map').setView([45.5184, -122.6756], 11);

L.tileLayer('https://tiles.stadiamaps.com/tiles/stamen_toner_lite/{z}/{x}/{y}{r}.png?api_key=7049c2c0-1dc3-4a7e-a46f-98d46cfbcb2b', {
    maxZoom: 19,
    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> | <a href="http://stamen.com">Stamen Design</a> | <a href="https://developer.trimet.org/gis/">TriMet</a>'
}).addTo(map);

L.geoJSON(tm_route_buffer_blockgroup, {onEachFeature:highlightLayer}).addTo(map);

function highlightLayer(feature, layer) {
  layer.on('click', function(e) {
        e.target.setStyle({
            color: '#333333',
            weight: 2,
            opacity:1
        });
        alert("You clicked the map at " + e.latlng);
    });
}

const apiUrl = 'https://maps.trimet.org/otp_mod/plan';
const params = {
  mode: "WALK,BUS,TRAM,RAIL,GONDOLA",
  fromPlace: '45.521645, -122.485306',
  toPlace: '45.501139, -122.433799',
  date: '2024-09-15',
  time: '12:00',
  maxWalkDistance: 536,
  walkSpeed: 1.34,
  numItineraries: 2
};

// Create a URLSearchParams object from the parameters
const searchParams = new URLSearchParams(params);

// Construct the full URL with query parameters
const url = `${apiUrl}?${searchParams}`;

fetch(url)
  .then(response => response.json())
  .then(data => {
    // Handle the API response data
    console.log(data);
  })
  .catch(error => {
    // Handle any errors
    console.error(error);
  });

</script>
 
</body>
</html>
